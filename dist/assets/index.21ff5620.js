var f=Object.defineProperty;var b=(m,e,t)=>e in m?f(m,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):m[e]=t;var c=(m,e,t)=>(b(m,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerpolicy&&(s.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?s.credentials="include":a.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();class v{constructor(e,t){c(this,"renderRecipeModalItems",e=>{this.view.createModalContent(e,this.view.recipeModalContainer)});c(this,"renderBackPackModalItems",e=>{this.view.createModalContent(e,this.view.backPackModalContainer)});c(this,"onRecipesChanged",e=>{this.view.createModalContent(e,this.view.recipeModalContainer)});c(this,"handleAddNewRecipe",e=>{const t=this.model.addRecipe(e);this.onRecipesChanged(t)});this.model=e,this.view=t,this.renderRecipeModalItems(this.model.recipes),this.renderBackPackModalItems(this.model.backPackItems),this.renderNewRecipeOption(this.model.backPackItems),this.view.bindClickTargetItem(this.model.recipes),this.onRecipesChanged(this.model.recipes),this.view.bindAddNewRecipeBtn(this.handleAddNewRecipe)}renderNewRecipeOption(e){this.view.createNewItemOptions(this.model.backPackItems)}}class E{constructor(){this.events={}}subscribe(e,t){!this.events[e]&&(this.events[e]=[]),t.forEach(i=>this.events[e].push(i))}unsubscribe(e,t){this.events[e]=this.events[e].filter(i=>t!==i)}emit(e,t){const i=this.events[e];i&&i.forEach((a,s)=>a.call(null,t[s]))}}const l=new E,_=[{name:"blitzKnuckles",image:"./images/item/blitzKnuckles.jpg"},{name:"claymore",image:"../images/item/claymore.jpg"},{name:"demonEdge",image:"images/item/demonEdge.jpg"},{name:"eaglesong",image:"../../../images/item/eaglesong.jpg"},{name:"javelin",image:"../../../images/item/javelin.jpg"},{name:"mithrilHammer",image:"../../../images/item/mithrilHammer.jpg"},{name:"pointBooster",image:"../../../images/item/pointBooster.jpg"},{name:"quarterstaff",image:"../../../images/item/quarterstaff.jpg"},{name:"sacredRelic",image:"../../../images/item/sacredRelic.jpg"},{name:"shadowAmulet",image:"../../../images/item/shadowAmulet.jpg"},{name:"talismanOfEvasion",image:"../../../images/item/talismanOfEvasion.jpg"},{name:"ultimateOrb",image:"../../../images/item/ultimateOrb.jpg"},{name:"beltOfStrength",image:"../../../images/item/beltOfStrength.jpg"},{name:"bladeOfalacrity",image:"../../../images/item/bladeOfalacrity.jpg"},{name:"bootsOfSpeed",image:"../../../images/item/bootsOfSpeed.jpg"},{name:"ghostScepter",image:"../../../images/item/ghostScepter.jpg"},{name:"glovesOfHaste",image:"../../../images/item/glovesOfHaste.jpg"},{name:"kaya",image:"../../../images/item/kaya.jpg"},{name:"morbidMask",image:"../../../images/item/morbidMask.jpg"},{name:"ogreAxe",image:"../../../images/item/ogreAxe.jpg"},{name:"recipe",image:"../../../images/item/recipe.jpg"},{name:"sagesMask",image:"../../../images/item/sagesMask.jpg"},{name:"staffOfWizardry",image:"../../../images/item/staffOfWizardry.jpg"},{name:"talismanOfEvasion",image:"../../../images/item/talismanOfEvasion.jpg"}],u="/assets/recipe.b1732290.jpg",k=[{name:"aghanims_scepter",image:"../../../images/goods/aghanims_scepter.jpg",ingredients:["pointBooster","staffOfWizardry","ogreAxe","bladeOfalacrity"]},{name:"butterfly",image:"../../../images/goods/butterfly.jpg",ingredients:["eaglesong","quarterstaff","talismanOfEvasion"]},{name:"divine_rapier",image:"../../../images/goods/divine_rapier.jpg",ingredients:["demonEdge","sacredRelic"]},{name:"ethereal_blade",image:"../../../images/goods/ethereal_blade.jpg",ingredients:["ghostScepter","kaya","recipe"]},{name:"eye_of_skadi",image:"../../../images/goods/eye_of_skadi.jpg",ingredients:["ultimateOrb","ultimateOrb","pointBooster"]},{name:"maelstrom",image:"../../../images/goods/maelstrom.jpg",ingredients:["mithrilHammer","javelin"]},{name:"mask_of_madness",image:"../../../images/goods/mask_of_madness.jpg",ingredients:["morbidMask","quarterstaff"]},{name:"power_treads",image:"../../../images/goods/power_treads.jpg",ingredients:["beltOfStrength","glovesOfHaste","bootsOfSpeed"]},{name:"ring_of_basilius",image:"../../../images/goods/ring_of_basilius.jpg",ingredients:["sagesMask","recipe"]},{name:"shadow_blade",image:"../../../images/goods/shadow_blade.jpg",ingredients:["claymore","shadowAmulet","blitzKnuckles"]}];class I{constructor(){const e=JSON.parse(localStorage.getItem("items"));this.recipes=e||k,this.backPackItems=_}addRecipe(e){const{name:t,ingredients:i}=e,a={name:t,image:u,ingredients:i};return this.recipes.find(r=>r.name===t)?(alert("\u0420\u0435\u0446\u0435\u043F\u0442 \u0441 \u0442\u0430\u043A\u0438\u043C \u0438\u043C\u0435\u043D\u0435\u043C \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442!"),this.recipes):(this.recipes.length<20?(this.recipes.push(a),localStorage.setItem("items",JSON.stringify(this.recipes))):alert("\u0414\u043E\u0441\u0442\u0438\u0433\u043D\u0443\u0442\u043E \u043C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u043E\u0435 \u043A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E \u0440\u0435\u0446\u0435\u043F\u0442\u043E\u0432!"),alert("\u0420\u0435\u0446\u0435\u043F\u0442 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0441\u043E\u0437\u0434\u0430\u043D!"),this.recipes)}}const w="/assets/backPack.d51588b0.png";class C{constructor(){c(this,"createCraftCells",e=>{this.craftContainer=document.querySelector(".craft__wrapp"),this.craftContainer.innerHTML="",e.ingredients.forEach(t=>{const i=this.createElement("img"),a=`../../../images/item/${t}.jpg`;i.className="dragZoneCell",i.setAttribute("data-zone",t),i.src=a,this.craftContainer.append(i)})});c(this,"createCurrentIteImage",e=>{const t=this.createElement("img"),i=this.createElement("div","currentItem__describe"),{itemImageUrl:a,itemName:s}=e,r=document.querySelector(".currentItem");r.innerHTML="",i.innerText=s,t.src=a,r.append(t,i)});c(this,"showDeskCraftListeners",()=>{const e=this.getElement(".validateText"),t=this.getElement(".craftBtn"),i=this.getElement(".progressBar__wrapp");[e,t,i].forEach(a=>a.style.opacity=1)});c(this,"reloadCraft",()=>{alert(`\u041F\u0440\u0435\u0434\u043C\u0435\u0442 ${this.targetItem} \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0441\u043E\u0437\u0434\u0430\u043D!`),this.deskWrapper.innerHTML="";const e=this.createDesk();this.deskWrapper.append(e)});c(this,"fillInProgress",()=>{const e=this.validateCraftStatus(),t=this.getElement(".progressBar").clientWidth,i=this.getElement(".progressBar__fill"),a=this.getElement(".percentProgress"),s=this.getElement(".progressBar__pointer").clientWidth,r=10,n=50,o=()=>{if(i.clientWidth>=t-s)return this.reloadCraft();i.style.width=`${i.clientWidth+r}px`,a.innerText=`${Math.ceil(i.clientWidth/(t-s)*100)}%`,setTimeout(o,n)};e&&o()});c(this,"resetForm",()=>{this.input.value="",this.ingredients.innerHTML="",this.newRecipe.name="",this.newRecipe.ingredients=[]});c(this,"validateNewItem",()=>{const e=this.input.value.trim().length;return e>10?(alert("\u0414\u043E\u043F\u0443\u0441\u0442\u0438\u043C\u043E\u0435 \u0447\u0438\u0441\u043B\u043E \u0431\u0443\u043A\u0432 \u0432 \u0440\u0435\u0446\u0435\u043F\u0442\u0435 - 10!"),!1):e<1?(alert("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0440\u0435\u0446\u0435\u043F\u0442\u0430!"),!1):this.newRecipe.ingredients.length<1?(alert("\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0445\u043E\u0442\u044F \u0431\u044B \u043E\u0434\u0438\u043D \u043F\u0440\u0435\u0434\u043C\u0435\u0442 \u0434\u043B\u044F \u043A\u0440\u0430\u0444\u0442\u0430 \u0440\u0435\u0446\u0435\u043F\u0442\u0430!"),!1):!0});c(this,"createNodeIngredientItem",e=>{const t=document.createElement("div"),i=document.createElement("div"),a=document.createElement("img");a.className="newItemButton",a.src="./images/close.png",t.className="newItemIngredients",a.setAttribute("name",e),i.innerText=e,t.append(i,a),this.ingredients.append(t)});c(this,"bindDeleteItem",e=>{this.body.addEventListener("click",t=>{if(t.target.classList.value==="newItemButton"){const s=t.target.getAttribute("name"),r=this.newRecipe.ingredients.indexOf(s);t.target.parentElement.remove(),this.newRecipe.ingredients=this.newRecipe.ingredients.filter((n,o)=>o!==r)}})});c(this,"bindDragActionDragZone",()=>{document.querySelectorAll(".dragZoneCell").forEach(t=>{t.addEventListener("dragenter",this.handlerDragEnter),t.addEventListener("dragleave",this.handleDragLeave),t.addEventListener("dragover",this.handleDragOver),t.addEventListener("drop",this.handleDragDrop)})});c(this,"bindDragActionDragItem",()=>{document.querySelectorAll(".img__item.backPack__image").forEach(t=>{t.addEventListener("dragstart",this.handlerDragStart),t.addEventListener("dragend",this.handleDragEnd)})});this.app=document.querySelector("#app"),this.body=this.getElement("body"),this.backPackModal=this.createModal("backPackModal__wrapp","backPackModal","backPackModal__btn","backPackModal__text","\u041F\u0440\u0435\u0434\u043C\u0435\u0442\u044B","backPackModal__img",w),this.recipeModal=this.createModal("recipeModal__wrapp","recipeModal","recipeModal__btn","recipeModal__text","\u0420\u0435\u0446\u0435\u043F\u0442\u044B","recipeModal__img",u),this.formAddNewRecipe=this.createFormAddNewRecipe(),this.deskWrapper=this.createElement("div","deskWrapp"),this.desk=this.createDesk(),this.deskWrapper.append(this.desk),this.app.append(this.backPackModal,this.deskWrapper,this.recipeModal,this.formAddNewRecipe),this.recipeModalContainer=document.querySelector(".recipeModal"),this.backPackModalContainer=document.querySelector(".backPackModal"),this.select=document.querySelector(".select"),this.newRecipeSaveBtn=this.getElement(".newRecipeSave"),this.input=this.getElement(".input"),this.ingredients=this.getElement(".ingredients"),this.form=this.getElement(".form"),this.modalCloseBtns=[this.getElement(".backPackModal__btn"),this.getElement(".recipeModal__btn"),this.getElement(".form__btn")],this.modals=[this.getElement(".backPackModal"),this.getElement(".recipeModal"),this.getElement(".form")],this.craftZone=this.getElement(".craft__wrapp"),this.newRecipe={name:"",ingredients:[]},this.targetItem="",l.subscribe("clickOnTargettem",[this.createCraftCells,this.createCurrentIteImage,this.showDeskCraftListeners]),l.subscribe("addListenerDragItems",[this.bindDragActionDragItem,this.bindDragActionDragZone]),l.subscribe("createNodeIngredientItem",[this.createNodeIngredientItem]),this.bindCreateNodeItem(),this.bindCraft(),this.bindDeleteItem(),this.bindtoggleModals()}createElement(e,t){return this.ele=document.createElement(e),t&&(this.ele.className=t),this.ele}getElement(e){return document.querySelector(e)}createModal(e,t,i,a,s,r,n){const o=this.createElement("div",e),d=this.createElement("div",t),g=this.createElement("button",i),p=this.createElement("div",a),h=this.createElement("img",r);return p.innerText=s,h.src=n,g.append(p,h),o.append(g,d),o}createModalContent(e,t){const i=t.classList.value;let a="";i==="recipeModal"&&(a="recipeModal__image"),i==="backPackModal"&&(a="backPack__image"),t.innerHTML="",e.forEach((s,r)=>{const n=this.createElement("img",`img__item ${a}`);return n.setAttribute("draggable","true"),n.setAttribute("data-item",r),n.setAttribute("name",s.name),n.src=s.image,t.appendChild(n)})}createDesk(){const e=this.createElement("div","desk"),t=this.createCurrentItem(),i=this.createProgressBar(),a=this.createCraftBtn(),s=this.createValidateText(),r=this.createDataZone();return e.append(t,i,a,s,r),e}createCurrentItem(){const e=this.createElement("div","currentItem"),t=this.createElement("img","currentItem__img"),i=this.createElement("div","currentItem__text");return i.innerText="\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0435\u0446\u0435\u043F\u0442!",e.append(i,t),e}createProgressBar(){const e=this.createElement("div","progressBar__wrapp"),t=this.createElement("div","progressBar"),i=this.createElement("div","progressBar__fill"),a=this.createElement("div","progressBar__pointer"),s=this.createPercentProgress();return t.append(i,a),e.append(t,s),e}createCraftBtn(){const e=this.createElement("button","craftBtn");return e.innerText="\u0417\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u044C",e}createValidateText(){const e=this.createElement("div","validateText");return e.innerText="\u0417\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u044F\u0447\u0435\u0439\u043A\u0438 \u0441\u043E\u043E\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044E\u0449\u0438\u043C\u0438 \u043F\u0440\u0435\u0434\u043C\u0435\u0442\u0430\u043C\u0438",e}createDataZone(){return this.createElement("div","craft__wrapp")}createPercentProgress(){const e=this.createElement("div","percentProgress");return e.innerText="0%",e}createFormAddNewRecipe(){const e=this.createElement("div","form__wrapper"),t=this.createElement("div","form__btn"),i=this.createElement("img","form__image"),a=this.createElement("div","title"),s=this.createElement("div","form"),r=this.createElement("div","form__label"),n=this.createElement("div","newRecipeName"),o=this.createElement("input","input"),d=this.createElement("div","ingredients"),g=this.createElement("div","ingredients__text"),p=this.createElement("select","select"),h=this.createElement("button","newRecipeSave");return a.innerText="\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u0440\u0435\u0446\u0435\u043F\u0442",n.innerText="\u041F\u0440\u0438\u0434\u0443\u043C\u0430\u0439\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0434\u043B\u044F \u043D\u043E\u0432\u043E\u0433\u043E \u0440\u0435\u0446\u0435\u043F\u0442\u0430",o.placeholder="\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0440\u0435\u0446\u0435\u043F\u0442\u0430",g.innerText="\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u044B \u043F\u0440\u0435\u0434\u043C\u0435\u0442\u044B \u0434\u043B\u044F \u0440\u0435\u0446\u0435\u043F\u0442\u0430",h.innerText="\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",i.src=u,p.size=6,r.append(n,o),t.append(i,a),s.append(r,n,o,d,g,p,h),e.append(t,s),e}createNewItemOptions(e){e.forEach(t=>{const i=document.createElement("option"),a=t.name;i.className="option",i.innerText=a,i.value=a,this.select.append(i)})}validateCraftStatus(){this.dragZoneCells=document.querySelectorAll(".dragZoneCell");let e=!0;return this.dragZoneCells.length<1&&(e=!1),this.dragZoneCells.forEach(t=>{t.getAttribute("successItem")||(e=!1)}),e}createNewItem(){if(this.newRecipe.ingredients.length<4){const t=this.value;this.newRecipe.ingredients.push(t),this.createNodeItems(t)}else alert("\u0420\u0435\u0446\u0435\u043F\u0442 \u043C\u043E\u0436\u0435\u0442 \u0441\u043E\u0434\u0435\u0440\u0436\u0430\u0442\u044C \u043D\u0435 \u0431\u043E\u043B\u0435\u0435 \u0447\u0435\u0442\u044B\u0440\u0435\u0445 \u043F\u0440\u0435\u0434\u043C\u0435\u0442\u043E\u0432!")}handlerDragStart(e){e.dataTransfer.setData("dragItem",this.dataset.item)}handlerDragEnter(e){e.preventDefault()}handleDragOver(e){e.preventDefault()}handleDragDrop(e){const t=e.dataTransfer.getData("dragItem");document.querySelector(`[data-item="${t}"]`).getAttribute("name")===this.getAttribute("data-zone")?(this.setAttribute("successItem",!0),this.style.filter="grayscale(0)",this.style.opacity=1):alert("\u041F\u0440\u0435\u0434\u043C\u0435\u0442 \u043D\u0435 \u043F\u043E\u0434\u0445\u043E\u0434\u0438\u0442!")}bindValidateNewRecipeNameExist(e){const t=this.newRecipe.name;return e.filter(i=>i===t).length}bindAddNewRecipeBtn(e){this.body.addEventListener("click",t=>{if(t.target.classList.value==="newRecipeSave"&&this.validateNewItem()){const r=this.input.value;this.newRecipe.name=r,e(this.newRecipe),this.resetForm()}})}bindCraft(){this.body.addEventListener("click",e=>{if(e.target.classList.value==="craftBtn"){const a=this.validateCraftStatus(),s=this.getElement(".validateText");a?(s.innerText="\u041A\u0440\u0430\u0444\u0442\u0438\u043C!",s.style.color="green"):(s.innerText="\u0417\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u044F\u0447\u0435\u0439\u043A\u0438 \u0441\u043E\u043E\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044E\u0449\u0438\u043C\u0438 \u043F\u0440\u0435\u0434\u043C\u0435\u0442\u0430\u043C\u0438",s.style.color="red")}this.fillInProgress()})}bindCreateNodeItem(){this.body.addEventListener("click",e=>{e.target.classList.value;const t="option",i=4,a=this.newRecipe.ingredients.length;if(e.target.classList.value===t)if(a<i){const s=e.target.value;this.newRecipe.ingredients.push(s),l.emit("createNodeIngredientItem",[s])}else alert("\u0420\u0435\u0446\u0435\u043F\u0442 \u043C\u043E\u0436\u0435\u0442 \u0441\u043E\u0434\u0435\u0440\u0436\u0430\u0442\u044C \u043D\u0435 \u0431\u043E\u043B\u0435\u0435 \u0447\u0435\u0442\u044B\u0440\u0435\u0445 \u043F\u0440\u0435\u0434\u043C\u0435\u0442\u043E\u0432!")})}bindtoggleModals(){this.modals.forEach((e,t)=>{this.modalCloseBtns[t].addEventListener("click",()=>{e.classList.toggle("hide")})})}bindClickTargetItem(e){this.body.addEventListener("click",t=>{const i="img__item recipeModal__image";if(t.target.classList.value===i){const a=t.target.getAttribute("name"),s=e.filter(d=>d.name===a)[0],r=s.image,n=s.name,o={itemImageUrl:r,itemName:n};this.targetItem=a,l.emit("clickOnTargettem",[s,o]),l.emit("addListenerDragItems",[])}})}}new v(new I,new C);
